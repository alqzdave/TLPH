<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TLPH | Compact National Dashboard</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root { --gov-navy: #002e5f; --gov-steel: #475569; --gov-bg: #f1f5f9; }
    
    /* Full Height / No Scroll Body */
    html, body { height: 100vh; overflow: hidden; } 
    body { 
      font-family: "Inter", sans-serif; 
      font-size: 0.72rem; 
      background-color: var(--gov-bg);
      color: #1e293b;
    }

    .wrapper { display: flex; height: 100vh; overflow: hidden; }
    main { flex: 1; display: flex; flex-direction: column; padding: 0.5rem 1rem; overflow: hidden; min-width: 0; }

    /* Cards - Compact Style */
    .card { border-radius: 2px; border: 1px solid #cbd5e1; background: #fff; margin-bottom: 0.5rem; box-shadow: none; }
    .card-header {
      background: #f8fafc; font-weight: 700; font-size: 0.62rem;
      text-transform: uppercase; color: var(--gov-navy);
      padding: 0.3rem 0.6rem; border-bottom: 1px solid #cbd5e1;
    }

    /* Table Density */
    .table-responsive { flex-grow: 1; overflow-y: auto; border: 1px solid #cbd5e1; background: #fff; }
    .table-registry thead th {
      position: sticky; top: 0; background: #f1f5f9; z-index: 10;
      font-size: 0.6rem; padding: 0.5rem !important; border-bottom: 2px solid #cbd5e1;
    }
    .table-registry td { padding: 0.35rem 0.6rem !important; vertical-align: middle; border-bottom: 1px solid #e2e8f0; }

    /* Chart Heights */
    .chart-container { position: relative; height: 120px; width: 100%; }

    /* Form Elements */
    .form-control-sm, .form-select-sm { font-size: 0.7rem; border-radius: 2px; height: 28px; }
    .badge { font-size: 0.58rem !important; border-radius: 2px; }
  </style>
</head>

<body>

<div class="wrapper">
  <div class="hidden lg:block w-64 bg-slate-900">
    {% include 'national/sidenav-national.html' %}
  </div>

  <main>
    <div class="d-flex justify-content-between align-items-end mb-2 border-bottom border-2 border-dark pb-1">
      <div>
        <h6 class="fw-bold m-0 text-uppercase" style="color: var(--gov-navy); font-size: 0.85rem;">National Licensing & Permits Registry</h6>
        <div style="font-size: 0.6rem;" class="text-muted">Republic of the Philippines • Centralized Management System</div>
      </div>
      <div class="badge bg-secondary rounded-0">As of Feb 14, 2026</div>
    </div>

<div class="row g-2 mb-3">
  <div class="col-md-3">
    <div class="card h-100 border-0 shadow-sm" style="border-left: 5px solid #002e5f; background: #fff;">
      <div class="card-body p-2 px-3">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <div class="text-uppercase fw-bold text-muted" style="font-size: 0.6rem; letter-spacing: 1px;">Total Registered Records</div>
            <div class="h3 fw-bold m-0" style="color: #002e5f; font-family: 'Inter', sans-serif; letter-spacing: -1px;">3,102</div>
          </div>
          <span class="material-icons-round text-secondary opacity-25" style="font-size: 1.5rem;">account_balance</span>
        </div>
        <div class="mt-2 pt-1 border-top" style="font-size: 0.6rem;">
          <span class="fw-bold text-dark">61%</span> <span class="text-muted">of annual target reached</span>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card h-100 border-0 shadow-sm" style="border-left: 5px solid #157347; background: #fff;">
      <div class="card-body p-2 px-3">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <div class="text-uppercase fw-bold text-muted" style="font-size: 0.6rem; letter-spacing: 1px;">Approved Issuances</div>
            <div class="h3 fw-bold m-0 text-success" style="font-family: 'Inter', sans-serif; letter-spacing: -1px;">2,065</div>
          </div>
          <span class="material-icons-round text-success opacity-25" style="font-size: 1.5rem;">verified_user</span>
        </div>
        <div class="mt-2 pt-1 border-top" style="font-size: 0.6rem;">
          <span class="fw-bold text-success">66.6%</span> <span class="text-muted">Total compliance rate</span>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card h-100 border-0 shadow-sm" style="border-left: 5px solid #e67e22; background: #fff;">
      <div class="card-body p-2 px-3">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <div class="text-uppercase fw-bold text-muted" style="font-size: 0.6rem; letter-spacing: 1px;">Pending Evaluation</div>
            <div class="h3 fw-bold m-0" style="color: #d35400; font-family: 'Inter', sans-serif; letter-spacing: -1px;">788</div>
          </div>
          <span class="material-icons-round text-warning opacity-25" style="font-size: 1.5rem;">pending_actions</span>
        </div>
        <div class="mt-2 pt-1 border-top" style="font-size: 0.6rem;">
          <span class="fw-bold text-danger">22 Days</span> <span class="text-muted">Ave. processing time</span>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card h-100 border-0 shadow-sm" style="border-left: 5px solid #b91c1c; background: #fff;">
      <div class="card-body p-2 px-3">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <div class="text-uppercase fw-bold text-muted" style="font-size: 0.6rem; letter-spacing: 1px;">Expired / Delinquent</div>
            <div class="h3 fw-bold m-0 text-danger" style="font-family: 'Inter', sans-serif; letter-spacing: -1px;">214</div>
          </div>
          <span class="material-icons-round text-danger opacity-25" style="font-size: 1.5rem;">gavel</span>
        </div>
        <div class="mt-2 pt-1 border-top" style="font-size: 0.6rem;">
          <span class="fw-bold text-dark">98</span> <span class="text-muted">Urgent action required</span>
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="row g-2 flex-grow-1 overflow-hidden">
      <div class="col-md-3 d-flex flex-column gap-1">
        <div class="card flex-grow-1 mb-0">
          <div class="card-header">Filing Trend</div>
          <div class="card-body"><div class="chart-container"><canvas id="lpTrendChart"></canvas></div></div>
        </div>
        <div class="card flex-grow-1 mb-0">
          <div class="card-header">By Status</div>
          <div class="card-body"><div class="chart-container"><canvas id="lpStatusChart"></canvas></div></div>
        </div>
        <div class="card flex-grow-1 mb-0">
          <div class="card-header">By Region</div>
          <div class="card-body"><div class="chart-container"><canvas id="lpRegionChart"></canvas></div></div>
        </div>
      </div>

      <div class="col-md-9 d-flex flex-column overflow-hidden">
        <div class="card flex-grow-1 d-flex flex-column m-0">
          <div class="card-header bg-light p-2">
            <div class="row g-2 align-items-center">
              <div class="col-md-4">
                <div class="input-group input-group-sm">
                  <span class="input-group-text bg-white border-end-0"><span class="material-icons-round fs-6 text-muted">search</span></span>
                  <input type="text" id="liveSearchInput" class="form-control border-start-0 ps-0" placeholder="Search registry...">
                </div>
              </div>
              <div class="col-md-3">
                <select id="regionLiveFilter" class="form-select form-select-sm">
                  <option selected>All Regions</option><option>NCR</option><option>Region I</option><option>Region II</option>
                  <option>Region III</option><option>Region IV-A</option><option>BARMM</option>
                </select>
              </div>
              <div class="col-md-3">
                <select id="statusLiveFilter" class="form-select form-select-sm">
                  <option selected>All Status</option><option>Approved</option><option>Pending</option><option>Expired</option>
                </select>
              </div>
              <div class="col-md-2">
                <button id="btnRunQuery" class="btn btn-dark btn-sm w-100 fw-bold" style="background: var(--gov-navy);">RUN QUERY</button>
              </div>
            </div>
          </div>

 <div class="table-responsive">
            <table id="registryTable" class="table table-sm table-hover mb-0 table-registry">
              <thead>
                <tr class="text-uppercase text-muted">
                  <th>Reference & Applicant</th>
                  <th>Classification</th>
                  <th>Location</th>
                  <th class="text-center">Status</th>
                  <th>Issued/Expiry</th>
                  <th class="text-center">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><div class="fw-bold text-primary">LIC-2026-001284</div><div class="text-muted" style="font-size: 0.6rem;">Santos, Maria Clara</div></td>
                  <td class="text-uppercase fw-semibold">ECC Permit</td>
                  <td>Region IV-A / Laguna</td>
                  <td class="text-center"><span class="badge border" style="background: #fffbeb; color: #92400e; border-color: #fde68a;">EVALUATION PENDING</span></td>
                  <td class="text-muted small">— / —</td>
                  <td class="text-center">
                    <div class="btn-group">
                      <button class="btn btn-sm btn-outline-secondary p-0 px-1 border-0"><span class="material-icons-round fs-6">visibility</span></button>
                      <button class="btn btn-sm btn-outline-success p-0 px-1 border-0"><span class="material-icons-round fs-6">check_circle</span></button>
                      <button class="btn btn-sm btn-outline-danger p-0 px-1 border-0"><span class="material-icons-round fs-6">cancel</span></button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><div class="fw-bold text-primary">LIC-2026-001042</div><div class="text-muted" style="font-size: 0.6rem;">Dela Cruz, Juan</div></td>
                  <td class="text-uppercase fw-semibold">Permit to Operate</td>
                  <td>NCR / Quezon City</td>
                  <td class="text-center"><span class="badge border" style="background: #ecfdf5; color: #065f46; border-color: #a7f3d0;">OFFICIALLY APPROVED</span></td>
                  <td class="fw-semibold small">Feb 05, 2026 / 2027</td>
                  <td class="text-center"><button class="btn btn-outline-dark btn-sm py-0 px-2 fw-bold" style="font-size: 0.6rem;">MANAGE</button></td>
                </tr>
                <tr>
                  <td><div class="fw-bold text-muted">LIC-2025-009981</div><div class="text-muted" style="font-size: 0.6rem;">Rivera, Liza</div></td>
                  <td class="text-uppercase fw-semibold">Water Discharge</td>
                  <td>BARMM / Cotabato</td>
                  <td class="text-center"><span class="badge border" style="background: #fef2f2; color: #991b1b; border-color: #fecaca;">EXPIRED</span></td>
                  <td class="text-danger fw-bold small">Jan 08, 2026</td>
                  <td class="text-center"><button class="btn btn-warning btn-sm py-0 px-2 fw-bold" style="font-size: 0.6rem;">RENEW</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="p-2 px-3 bg-white border-top d-flex justify-content-between align-items-center">
            <span class="text-muted" style="font-size: 0.6rem;">Total: <strong>3,102 Records</strong></span>
            <button class="btn btn-outline-secondary btn-sm fw-bold px-2 d-flex align-items-center gap-1" style="font-size: 0.6rem;"><span class="material-icons-round fs-6">file_download</span> CSV</button>
          </div>

    <footer class="mt-2 text-center text-muted" style="font-size: 0.55rem; border-top: 1px solid #cbd5e1;">
      OFFICIAL USE ONLY • Republic of the Philippines • v2.1
    </footer>
  </main>
</div>

<script>
  // Parehong logic, compact version charts
  const sharedOpts = { 
    maintainAspectRatio: false, 
    plugins: { legend: { position: 'bottom', labels: { boxWidth: 6, font: { size: 8 } } } }, 
    scales: { y: { ticks: { font: { size: 8 } } }, x: { ticks: { font: { size: 8 } } } } 
  };
  
  new Chart(document.getElementById('lpTrendChart'), { type: 'line', data: { labels: ['S', 'O', 'N', 'D', 'J', 'F'], datasets: [{ label: 'Issued', data: [43, 48, 52, 61, 54, 55], borderColor: '#002e5f', tension: 0.2 }] }, options: sharedOpts });
  new Chart(document.getElementById('lpStatusChart'), { type: 'pie', data: { labels: ['Apprv', 'Pend', 'Exp'], datasets: [{ data: [2065, 788, 98], backgroundColor: ['#166534', '#854d0e', '#991b1b'] }] }, options: sharedOpts });
  new Chart(document.getElementById('lpRegionChart'), { type: 'bar', data: { labels: ['R4A', 'NCR', 'R7', 'R3', 'BAR'], datasets: [{ data: [68, 61, 39, 30, 18], backgroundColor: '#475569' }] }, options: sharedOpts });

  function runLiveRegistryFilter() {
    const searchVal = document.getElementById('liveSearchInput').value.toLowerCase();
    const regionVal = document.getElementById('regionLiveFilter').value;
    const statusVal = document.getElementById('statusLiveFilter').value;
    const rows = document.querySelectorAll('#registryTable tbody tr');

    rows.forEach(row => {
      const content = row.innerText.toLowerCase();
      const matchesSearch = content.includes(searchVal);
      const matchesRegion = (regionVal === "All Regions" || content.includes(regionVal.toLowerCase()));
      const matchesStatus = (statusVal === "All Status" || content.includes(statusVal.toLowerCase()));
      row.style.display = (matchesSearch && matchesRegion && matchesStatus) ? "" : "none";
    });
  }

  document.getElementById('liveSearchInput').addEventListener('input', runLiveRegistryFilter);
  document.getElementById('regionLiveFilter').addEventListener('change', runLiveRegistryFilter);
  document.getElementById('statusLiveFilter').addEventListener('change', runLiveRegistryFilter);
  document.getElementById('btnRunQuery').addEventListener('click', runLiveRegistryFilter);
</script>

</body>
</html>